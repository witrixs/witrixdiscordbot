# üéÆ witrix Discord Bot ‚Äî —É—Ä–æ–≤–Ω–∏, –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, —Ä–æ–ª–∏ + Web-–ø–∞–Ω–µ–ª—å (FastAPI + Vue + discord.py)

> –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: Discord-–±–æ—Ç –Ω–∞ **discord.py** —Å —Å–∏—Å—Ç–µ–º–æ–π —É—Ä–æ–≤–Ω–µ–π (XP, —Å–æ–æ–±—â–µ–Ω–∏—è, –¥–Ω–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ), –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è–º–∏ —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π, –≤—ã–±–æ—Ä–æ–º —Ä–æ–ª–µ–π + **Vue 3** –≤–µ–±-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞–º–∏ (REST API). Backend ‚Äî **FastAPI**, –ë–î ‚Äî **SQLite** –∏–ª–∏ **PostgreSQL**.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏](#-–æ—Å–Ω–æ–≤–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏)
- [API Endpoints](#-api-endpoints)
- [–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞](#-–∫–æ–º–∞–Ω–¥—ã-–±–æ—Ç–∞)
- [–°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π](#-—Å–∏—Å—Ç–µ–º–∞-—É—Ä–æ–≤–Ω–µ–π)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- [–ü–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –Ω–∞ GitHub](#-–ø–µ—Ä–µ–¥-–ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π-–Ω–∞-github)

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend
- **FastAPI** ‚Äî REST API
- **discord.py** ‚Äî Discord Bot API (—Å–ª—ç—à-–∫–æ–º–∞–Ω–¥—ã, —Å–æ–±—ã—Ç–∏—è)
- **SQLAlchemy** ‚Äî –ë–î (SQLite / PostgreSQL)
- **PyJWT** ‚Äî JWT –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **Passlib (bcrypt)** + –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ **Werkzeug** ‚Äî —Ö—ç—à–∏ –ø–∞—Ä–æ–ª–µ–π –∞–¥–º–∏–Ω–æ–≤
- **Pillow (PIL)** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ (–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, –∫–∞—Ä—Ç–æ—á–∫–∞ —É—Ä–æ–≤–Ω—è)
- **aiohttp** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–æ–≤ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫

### Frontend
- **Vue 3** ‚Äî –≤–µ–±-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **Vue Router** ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- **Vite** ‚Äî —Å–±–æ—Ä–∫–∞ –∏ dev-—Å–µ—Ä–≤–µ—Ä (–ø—Ä–æ–∫—Å–∏ –∫ API)

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **SQLite** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ **PostgreSQL** ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫–∏, —É—Ä–æ–≤–Ω–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–ª—å–¥–∏–π, –∞–¥–º–∏–Ω—ã, –ø—Ä–µ—Ñ—ã Discord

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python 3.10+**
- **Node.js 18+** (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)
- **Discord Application** (–±–æ—Ç + OAuth2 –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ø–∞–Ω–µ–ª—å)

---

# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

> **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç** - –ó–∞–ø—É—Å—Ç–∏—Ç–µ witrixdiscordbot –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç

### –î–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É.

---

**SQLite:**
```bash
curl -fsSL https://raw.githubusercontent.com/witrixs/script/main/witrixdriscordbot/scripts/witrix.sh -o /tmp/witrixdiscordbot.sh \
  && sed -i 's/\r$//' /tmp/witrixdiscordbot.sh \
  && sudo bash /tmp/witrixdiscordbot.sh install \
  && sudo bash /tmp/witrixdiscordbot.sh install-script
```

### üìã –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

<div align="left">

**‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` –∫–æ–º–∞–Ω–¥–æ–π `witrixdiscordbot edit-env` –∏ –¥–∞–ª–µ–µ `witrixdiscordbot up`**

**üìã –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏** (–Ω–∞–∂–º–∏—Ç–µ `Ctrl+C` –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)

**üìÅ –§–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤** `/opt/witrixdiscordbot`

**‚öôÔ∏è –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** `/opt/witrixdiscordbot/.env` (—Å–º. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π)

**üíæ –§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö:** `/var/lib/witrixdiscordbot`

**üîí –í–∞–∂–Ω–æ:** –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü–æ–ª—É—á–∏—Ç—å SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç: –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –ª—é–±–æ–π –∏–∑ –≤–µ–± —Å–µ—Ä–≤–µ—Ä–æ–≤ (—Å–º–æ—Ç—Ä–∏  –Ω–∏–∂–µ –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞—Ç—å)

**üîó –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –¥–æ–º–µ–Ω–∞:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH port forwarding (—Å–º. –Ω–∏–∂–µ)

</div>

---

```bash
ssh -L 4000:localhost:4000 user@serverip
```

–ó–∞—Ç–µ–º –¥–æ—Å—Ç—É–ø: `http://localhost:4000/dashboard/`

> ‚ö†Ô∏è **–¢–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - –í—ã –ø–æ—Ç–µ—Ä—è–µ—Ç–µ –¥–æ—Å—Ç—É–ø –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ SSH-—Ç–µ—Ä–º–∏–Ω–∞–ª–∞.

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repo-url>
cd witrixdiscordbot
```

### 2. Backend (FastAPI + –±–æ—Ç)

```bash
# –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
python -m venv venv
# Windows:
venv\Scripts\activate
# Linux/macOS:
# source venv/bin/activate

pip install -r requirements.txt
```

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Å–º. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)).

–ó–∞–ø—É—Å–∫ (API –Ω–∞ –ø–æ—Ä—Ç—É 4000 + Discord-–±–æ—Ç –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ):

```bash
python main.py
```

### 3. Frontend (Vue + Vite)

```bash
cd frontend
npm install
npm run dev
```

Frontend –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:5173` (–ø—Ä–æ–∫—Å–∏ `/api` ‚Üí `http://localhost:4000`).

### 4. –ü—Ä–æ–¥–∞–∫—à–µ–Ω: –æ–¥–Ω–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

–ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (`npm run build`) —Å—Ç–∞—Ç–∏–∫–∞ –æ—Ç–¥–∞—ë—Ç—Å—è —Å–∞–º–∏–º FastAPI –∏–∑ `frontend/dist`. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ backend:

```bash
cd frontend && npm run build && cd ..
python main.py
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ `http://127.0.0.1:4000` (API ‚Äî `http://127.0.0.1:4000/api`).

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª `.env` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)

```env
## Discord Bot
DISCORD_TOKEN=your_discord_bot_token

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
DB_URL=sqlite:///bot.db
# PostgreSQL –ø—Ä–∏–º–µ—Ä:
# DB_URL=postgresql://user:pass@localhost:5432/dbname

## JWT –∏ –≤–µ–±-–ø–∞–Ω–µ–ª—å
SECRET_KEY=replace_me_with_strong_secret

## –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ (–±–µ–∑ —Å–ª–µ—à–∞ –≤ –∫–æ–Ω—Ü–µ)
FRONTEND_URL=http://localhost:5173

## Discord OAuth2 ‚Äî –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ø–∞–Ω–µ–ª—å —á–µ—Ä–µ–∑ Discord
DISCORD_CLIENT_ID=your_client_id
DISCORD_CLIENT_SECRET=your_client_secret
# –ü–æ–ª–Ω—ã–π URL –∫–æ–ª–±—ç–∫–∞ (–∫–∞–∫ –≤ Discord Developer Portal)
DISCORD_REDIRECT_URI=http://localhost:4000/api/auth/discord/callback

## –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –¥–ª—è –≤–µ–±-–ø–∞–Ω–µ–ª–∏ (–≤–º–µ—Å—Ç–æ –∏–ª–∏ –≤–º–µ—Å—Ç–µ —Å Discord)
# ADMIN_USERNAME=admin
# ADMIN_PASSWORD=your_password

## –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞ –≤ Discord
# BOT_STATUS_TYPE=listening   # playing | listening | watching
# BOT_STATUS_NAME=ALBLAK 52

## CORS (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é *)
# CORS_ORIGINS=http://localhost:5173
```

–í–∞–∂–Ω–æ:
- `DISCORD_TOKEN` –∏ `SECRET_KEY` **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã** –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ –∏ API.
- –î–ª—è –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Discord –Ω—É–∂–Ω—ã `DISCORD_CLIENT_ID`, `DISCORD_CLIENT_SECRET`, `DISCORD_REDIRECT_URI`; –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Discord –¥–æ–±–∞–≤—å—Ç–µ Redirect URL: `http://localhost:4000/api/auth/discord/callback` (–Ω–∞ –ø—Ä–æ–¥–µ ‚Äî –≤–∞—à –¥–æ–º–µ–Ω).

### Frontend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–í `frontend/` –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è API (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–æ–∫—Å–∏ Vite):

```env
VITE_API_BASE_URL=http://localhost:4000
```

---

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –î–ª—è Discord
- üìä **–£—Ä–æ–≤–Ω–∏** ‚Äî XP –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (—Å 5 —É—Ä–æ–≤–Ω—è) –∏ –∑–∞ –¥–Ω–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ; –∫–∞—Ä—Ç–æ—á–∫–∞ –≤ `/level`
- üèÜ **–¢–æ–ø** ‚Äî `/top` –ø–æ —É—Ä–æ–≤–Ω—é
- üëã **–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è** ‚Äî –∫–∞–Ω–∞–ª + —Ä–æ–ª—å –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤, –∫–∞—Ä—Ç–∏–Ω–∫–∞ —Å –∞–≤–∞—Ç–∞—Ä–æ–º –∏ –Ω–æ–º–µ—Ä–æ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞
- üé≠ **–í—ã–±–æ—Ä —Ä–æ–ª–µ–π** ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ —Å select-–º–µ–Ω—é (`/setup_roles`), –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–∞ –∏ —Å–ø–∏—Å–∫–∞ —Ä–æ–ª–µ–π –≤ –ø–∞–Ω–µ–ª–∏
- üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤–æ–º —É—Ä–æ–≤–Ω–µ –≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª

### –î–ª—è Web-–ø–∞–Ω–µ–ª–∏
- üîê –í—Ö–æ–¥ —á–µ—Ä–µ–∑ **–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å** (–∞–¥–º–∏–Ω) –∏–ª–∏ **Discord OAuth2**
- üè∞ –í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ (–≥–∏–ª—å–¥–∏–∏), –≥–¥–µ –µ—Å—Ç—å –±–æ—Ç
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞: –∫–∞–Ω–∞–ª/—Ä–æ–ª—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, –∫–∞–Ω–∞–ª —É—Ä–æ–≤–Ω–µ–π, –∫–∞–Ω–∞–ª –∏ —Ä–æ–ª–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–µ–π
- üë• –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å —É—Ä–æ–≤–Ω—è–º–∏, XP, —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, –¥–Ω—è–º–∏; —Ä—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è/XP (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞)

---

## üîå API Endpoints

–í—Å–µ endpoints –ø–æ–¥ –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/api`.

### Auth
- `POST /api/auth/login` ‚Äî –ª–æ–≥–∏–Ω –ø–æ username/password, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT
- `GET /api/auth/me` ‚Äî —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (JWT)
- `PUT /api/auth/me/default-guild` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–¥–ª—è Discord-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- `GET /api/auth/discord` ‚Äî —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ Discord OAuth2
- `GET /api/auth/discord/callback` ‚Äî callback, –≤—ã–¥–∞—ë—Ç JWT –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Ñ—Ä–æ–Ω—Ç

### Guilds (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- `GET /api/guilds` ‚Äî —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ (—Å –±–æ—Ç–æ–º; –¥–ª—è Discord ‚Äî —Ç–æ–ª—å–∫–æ –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—á–∞—Å—Ç–Ω–∏–∫)
- `GET /api/guilds/{guild_id}/channels` ‚Äî –∫–∞–Ω–∞–ª—ã —Å–µ—Ä–≤–µ—Ä–∞
- `GET /api/guilds/{guild_id}/roles` ‚Äî —Ä–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞
- `GET /api/guilds/{guild_id}/config` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–ª—å–¥–∏–∏
- `PUT /api/guilds/{guild_id}/config` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∫–∞–Ω–∞–ª—ã, —Ä–æ–ª–∏ –¥–ª—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è/—É—Ä–æ–≤–Ω–µ–π/–≤—ã–±–æ—Ä–∞ —Ä–æ–ª–µ–π)
- `GET /api/guilds/{guild_id}/users/count` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- `GET /api/guilds/{guild_id}/users` ‚Äî —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)
- `GET /api/guilds/{guild_id}/users/{user_id}` ‚Äî –¥–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞
- `PUT /api/guilds/{guild_id}/users/{user_id}` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å/XP/—Å–æ–æ–±—â–µ–Ω–∏—è/–¥–Ω–∏ (–∞–¥–º–∏–Ω —Å–µ—Ä–≤–µ—Ä–∞)

---

## ü§ñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/level` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ —Å —É—Ä–æ–≤–Ω–µ–º, —Ä–∞–Ω–≥–æ–º, –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è (–æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –∫–∞–Ω–∞–ª —É—Ä–æ–≤–Ω–µ–π –∏–ª–∏ –≤ –õ–°)
- `/top` ‚Äî —Ç–æ–ø-10 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ —É—Ä–æ–≤–Ω—é
- `/help` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ + –∫–Ω–æ–ø–∫–∞ –Ω–∞ –≤–µ–±-–ø–∞–Ω–µ–ª—å
- `/setwelcome <–∫–∞–Ω–∞–ª> <—Ä–æ–ª—å>` ‚Äî –∫–∞–Ω–∞–ª –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ —Ä–æ–ª—å –¥–ª—è –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
- `/setup_roles` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –≤—ã–±–æ—Ä–æ–º —Ä–æ–ª–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)

---

## üìê –°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π

- **–£—Ä–æ–≤–Ω–∏ 1‚Äì5:** —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–π (0 ‚Üí 5 ‚Üí 15 ‚Üí 30 ‚Üí 50).
- **–£—Ä–æ–≤–µ–Ω—å 5+:** —É—Ä–æ–≤–µ–Ω—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ —Å—É–º–º–∞—Ä–Ω–æ–º—É XP (—Å—ã—Ä–æ–π XP + –±–æ–Ω—É—Å –∑–∞ –¥–Ω–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ).
- **XP:** +10 XP –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ —É—Ä–æ–≤–Ω–µ ‚â• 5; —Ä–∞–∑ –≤ 24 —á–∞—Å–∞ +1 –¥–µ–Ω—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –±–æ–Ω—É—Å: +15 XP –∑–∞ –∫–∞–∂–¥—ã–µ 2 –¥–Ω—è.
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ —Ñ–æ—Ä–º—É–ª—ã ‚Äî –≤ [LEVEL_RULES.md](LEVEL_RULES.md).

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
witrixdiscordbot/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/          # auth, guilds
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deps.py          # JWT, —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ router.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schemas.py       # Pydantic-–º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bot.py           # discord.py: –∫–æ–º–∞–Ω–¥—ã, —Å–æ–±—ã—Ç–∏—è, –∫–∞—Ä—Ç–∏–Ω–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py        # –∫–æ–Ω—Ñ–∏–≥ –∏–∑ .env
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guild_cache.py   # –∫—ç—à –≥–∏–ª—å–¥–∏–π/–∫–∞–Ω–∞–ª–æ–≤/—Ä–æ–ª–µ–π/—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ levels.py        # —Ä–∞—Å—á—ë—Ç —É—Ä–æ–≤–Ω—è, –ø–æ—Ä–æ–≥–∏ XP/—Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py      # —Ä–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py        # SQLAlchemy-–º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ base.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py              # FastAPI app, CORS, —Ä–∞–∑–¥–∞—á–∞ frontend/dist
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/             # –∫–ª–∏–µ–Ω—Ç API, auth, guilds
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views/           # Dashboard, Users, Settings, Auth
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ composables/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ router/
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.ts      # –ø—Ä–æ–∫—Å–∏ /api ‚Üí backend
‚îú‚îÄ‚îÄ fonts/                   # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: DejaVuSans.ttf –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞)
‚îú‚îÄ‚îÄ main.py                  # –∑–∞–ø—É—Å–∫ API –≤ –ø–æ—Ç–æ–∫–µ + –±–æ—Ç
‚îú‚îÄ‚îÄ .env                     # –ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å)
‚îú‚îÄ‚îÄ LEVEL_RULES.md           # –ø—Ä–∞–≤–∏–ª–∞ —É—Ä–æ–≤–Ω–µ–π
‚îî‚îÄ‚îÄ requirements.txt
```

---

## üö¢ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ (API + –±–æ—Ç + —Å—Ç–∞—Ç–∏–∫–∞)

```bash
cd frontend && npm run build && cd ..
python main.py
```

–ò–ª–∏ —á–µ—Ä–µ–∑ **Gunicorn** (—Ç–æ–ª—å–∫–æ API; –±–æ—Ç –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç –∏–∑ `main.py` ‚Äî –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –±–æ—Ç–∞ –∏–ª–∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞):

```bash
pip install gunicorn
gunicorn app.main:app -k uvicorn.workers.UvicornWorker -b 0.0.0.0:4000
```

–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –ª—É—á—à–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–º –∂–µ `python main.py`), –∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –≤—ã–Ω–µ—Å—Ç–∏ API –Ω–∞ Gunicorn –∏ —Ä–∞–∑–¥–∞–≤–∞—Ç—å —Å—Ç–∞—Ç–∏–∫—É —á–µ—Ä–µ–∑ Nginx.

### Nginx (HTTPS + SPA + API proxy)

```nginx
server {
    server_name domain.com;

    root /var/www/witrixdiscordbot/frontend/dist;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /api/ {
        proxy_pass http://127.0.0.1:4000/api/;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location = /api {
        return 301 /api/;
    }

    listen 443 ssl http2;
    ssl_certificate     /etc/letsencrypt/live/domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/domain.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
}

server {
    listen 80;
    server_name domain.com;
    return 301 https://$host$request_uri;
}
```
### Apache (HTTPS +API proxy)

```apache
<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName discord.rafaello.cc

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:4000/
    ProxyPassReverse / http://127.0.0.1:4000/

    # –ó–∞–≥–æ–ª–æ–≤–∫–∏
    RequestHeader set X-Real-IP %{REMOTE_ADDR}e
    RequestHeader set X-Forwarded-For %{REMOTE_ADDR}e
    RequestHeader set X-Forwarded-Proto %{REQUEST_SCHEME}e
SSLCertificateFile /etc/letsencrypt/live/discord.rafaello.cc/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/discord.rafaello.cc/privkey.pem
Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
</IfModule>
```
–ù–∞ –ø—Ä–æ–¥–µ –≤ `.env` —É–∫–∞–∂–∏—Ç–µ:
- `FRONTEND_URL=https://domain.com`
- `DISCORD_REDIRECT_URI=https://domain.com/api/auth/discord/callback`

---

## üìå –ü–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –Ω–∞ GitHub

- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ `.gitignore`).
- –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `.env.example` —Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞–º–∏ –≤–º–µ—Å—Ç–æ —Å–µ–∫—Ä–µ—Ç–æ–≤.
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–¥–µ –Ω–µ—Ç –∂—ë—Å—Ç–∫–æ –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –∏ –ø–∞—Ä–æ–ª–µ–π.

---

**‚ù§Ô∏è Dev by witrix**
